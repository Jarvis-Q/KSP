#!/usr/bin/env node

var program = require( 'commander' );
var Util = require( '../lib/util' );
var PackageBuilder = require( '../lib/packageBuilder');

// KSP info.
var packageInfo = require( '../package.json' );

program
    // Set version.
    .version( packageInfo.version )
    .option('-w, --wrapConfig', 'Wrap output code with KISSY package configuration.')
    .option('-c, --compress', 'Compress output code with UglifyJS.')
    // Parse the arguments.
    .parse(process.argv);


// Get KSP config, if Fail, terminal this task.
var kspConfig = Util.parseConfig();

kspConfig.main.forEach(function( mainPath ){

    PackageBuilder( kspConfig, mainPath, {
        ifComboConfig: program.wrapConfig,
        ifCompress: program.compress
    });
});